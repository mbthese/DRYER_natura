theme(legend.text = element_text(size = 15, face = "italic"), legend.title = element_blank())
rarefaction_root_fungi <- p + ggtitle("B. Rarefaction curves - Root fungi")+
theme(legend.text = element_text(size = 15, face = "italic"), legend.title = element_blank())
rarefaction_leaf_fungi <- p + ggtitle("A. Rarefaction curves - Leaf fungi")+
theme(legend.text = element_text(size = 15, face = "italic"), legend.title = element_blank())
rarefaction <- ggarrange(rarefaction_leaf_fungi, rarefaction_root_fungi, rarefaction_leaf_bacteria, rarefaction_root_bacteria, nrow = 2, ncol = 2, common.legend = TRUE, legend = "bottom")
rarefaction
ggsave(filename = "Rarefaction_curves.png", plot = rarefaction, bg = "white", width = 12, height = 10, dpi = 600)
source("E:/Sophie_pipeline/obitools/script/NDV_script.R")
load("./resources/Metabarlist_natura_clean_ITS2_traits_alpha.Rdata")
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose_hel.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose_hel.RData") #ro
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p<2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 0.8)
plot_ITS
ggsave("./results/plot_ITS_ndv_hell.jpeg", plot_ITS)
# load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose_hel.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose_hel.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p-value=0.43", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 0.8)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot_hell.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
ggsave("./results/null/plot_final_ndv_hel.jpeg", NDV_final_plot, width = 10, height = 8 )
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p<2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 0.8)
plot_ITS
ggsave("./results/plot_ITS_ndv.jpeg", plot_ITS)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p<2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 5)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p<2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1)
plot_ITS
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.9,label="T.test, p<2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.95,label="t = -18.013, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=0.98,label="t = -18.013, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.013, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.1)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.013, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
# load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p-value=0.43", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 0.8)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p-value=0.43", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot_hell.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
ggsave("./results/null/plot_final_ndv.jpeg", NDV_final_plot, width = 10, height = 8 )
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_ITS_leaf.RData") #leaf
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_fun.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root.RData") #root
load("./results/null/bray_abund_null_dev_fun_root.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
# load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_16S_leaf.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#datasets----------
load("./resources/Metabarlist_natura_clean_ITS2_traits_alpha.Rdata") #fungi
# leaf------------
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
leaf$reads
# Prepare and calculate abundance beta-null deviation metric
comm.t=t(leaf$reads) #transpose reads
View(comm.t)
# Prepare and calculate abundance beta-null deviation metric
comm.t=t(leaf$reads) #transpose reads
# Prepare and calculate abundance beta-null deviation metric
comm.t=leaf$reads #transpose reads
View(comm.t)
bbs.sp.site <- comm.t
patches=nrow(bbs.sp.site)
patches
#
# ## Calculate beta-diversity for observed metacommunity
beta_comm_abund <- vegdist(comm.t.root, "bray")
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_fun.RData") #leaf
load("./results/null/bray_abund_null_dev_fun_root.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.35, 1.05)
plot_ITS
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.35, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_ITS
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
ggsave("./results/null/plot_final_ndv.jpeg", NDV_final_plot, width = 10, height = 8 )
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
