leaf_fungi_taxo <- as.data.frame(colSums(taxonomy)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy)`) %>% mutate( `Fungi Leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,2)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy)`) %>% mutate( `Fungi Leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,2))
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy)`) %>% mutate( `Fungi Leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
root_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
taxo_leaf_fungi <- leaf_fungi$motus %>% dplyr::select(c(4:10))
taxo_root_fungi <- root_fungi$motus %>% dplyr::select(c(4:10))
#add root
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy)`) %>% mutate( `Fungi root Assignation(%)` = round(nbr_fungi_root/ 10099*100,digits=2))
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root Assignation(%)` = round(nbr_fungi_root/ 10099*100,digits=2))
View(root_fungi_taxo)
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo)
View(fungi_assignation)
as.data.frame(colSums(taxonomy_root_fungi))
View(taxonomy_root_fungi)
summary(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root Assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo)
View(root_fungi_taxo)
View(fungi_assignation)
is.na.data.frame(taxo_root_fungi)
summary(is.na.data.frame(taxo_root_fungi))
#now for bacteria dataset
load("./resources/Metabarlist_natura_clean_16S_traits.Rdata")
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(4:10))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(4:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- ifelse(is.na(taxo_leaf_bacteria$Species), 0, 1)
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria Leaf Assignation(%)` = round(nbr_bacteria_leaf/ 10099*100,digits=2))
summary(is.na.data.frame(taxonomy_leaf_bacteria))
summary((taxonomy_leaf_bacteria))
(taxonomy_leaf_bacteria)
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- ifelse(is.na(taxo_leaf_bacteria$Species), 0, 1)
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
leaf_bacteria$motus
colnames(leaf_bacteria$motus)
View(leaf_bacteria)
leaf_bacteria[["motus"]]
View(leaf_bacteria[["motus"]])
View(leaf_bacteria[["motus"]])
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(15:18))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(15:18))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$domain), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$order), 0, 1)
# taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
# taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
# taxonomy_leaf_bacteria$Species <- ifelse(is.na(taxo_leaf_bacteria$Species), 0, 1)
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
table(taxonomy_leaf_bacteria)
summary(taxonomy_leaf_bacteria)
summary(is.na(taxonomy_leaf_bacteria))
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria Leaf Assignation(%)` = round(nbr_bacteria_leaf/ 4301*100,digits=2))
View(leaf_bacteria_taxo)
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$domain), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$phylum), 0, 1)
#now for the root dataset
taxonomy_root_bacteria <- c()
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$domain), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$phylum), 0, 1)
taxonomy_root_bacteria$Class <- ifelse(is.na(taxo_root_bacteria$class), 0, 1)
taxonomy_root_bacteria$Order <- ifelse(is.na(taxo_root_bacteria$order), 0, 1)
# taxonomy_root_bacteria$Family <- ifelse(is.na(taxo_root_bacteria$Family), 0, 1)
# taxonomy_root_bacteria$Genus <- ifelse(is.na(taxo_root_bacteria$Genus), 0, 1)
# taxonomy_root_bacteria$Species <- ifelse(is.na(taxo_root_bacteria$Species), 0, 1)
taxonomy_root_bacteria <- as.data.frame(taxonomy_root_bacteria)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root Assignation(%)` = round(nbr_bacteria_root/ 5573*100,digits=2))
View(root_bacteria_taxo)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root Assignation(%)` = round(nbr_bacteria_root/ 4953*100,digits=2))
View(root_bacteria_taxo)
View(leaf_bacteria_taxo)
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo)
View(leaf_bacteria)
View(bacteria_assignation)
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% splyr::select(`bacteria Leaf Assignation(%)`, `bacteria root Assignation(%)`)
View(bacteria_assignation)
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria Leaf Assignation(%)`, `bacteria root Assignation(%)`)
View(bacteria_assignation)
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`fungi Leaf Assignation(%)`, `fungi root Assignation(%)`)
fungi_assignation
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`fungi leaf Assignation(%)`, `fungi root Assignation(%)`)
View(fungi_assignation)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `Fungi leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_fungi <- c()
taxonomy_leaf_fungi$Kingdom <- ifelse(is.na(taxo_leaf_fungi$Kingdom), 0, 1)
taxonomy_leaf_fungi$Phylum <- ifelse(is.na(taxo_leaf_fungi$Phylum), 0, 1)
taxonomy_leaf_fungi$Class <- ifelse(is.na(taxo_leaf_fungi$Class), 0, 1)
taxonomy_leaf_fungi$Order <- ifelse(is.na(taxo_leaf_fungi$Order), 0, 1)
taxonomy_leaf_fungi$Family <- ifelse(is.na(taxo_leaf_fungi$Family), 0, 1)
taxonomy_leaf_fungi$Genus <- ifelse(is.na(taxo_leaf_fungi$Genus), 0, 1)
taxonomy_leaf_fungi$Species <- ifelse(is.na(taxo_leaf_fungi$Species), 0, 1)
taxonomy_leaf_fungi <- as.data.frame(taxonomy_leaf_fungi)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `Fungi leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#now for the root dataset
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root Assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`Fungi leaf Assignation(%)`, `Fungi root Assignation(%)`)
View(fungi_assignation)
load("./results/Metabarlist_natura_clean_16S.Rdata")
View(natura_clean)
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(15:18))
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(15:18))
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(5:10))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(5:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$domain), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$order), 0, 1)
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- NA
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
View(taxonomy_leaf_bacteria)
taxonomy_leaf_bacteria$Species <- 0
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria Leaf Assignation(%)` = round(nbr_bacteria_leaf/ 4301*100,digits=2))
View(leaf_bacteria_taxo)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria Leaf Assignation(%)` = round(nbr_bacteria_leaf/ 3705*100,digits=2))
#now for the root dataset
taxonomy_root_bacteria <- c()
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$Kingdom), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$Phylum), 0, 1)
taxonomy_root_bacteria$Class <- ifelse(is.na(taxo_root_bacteria$Class), 0, 1)
taxonomy_root_bacteria$Order <- ifelse(is.na(taxo_root_bacteria$Order), 0, 1)
taxonomy_root_bacteria$Family <- ifelse(is.na(taxo_root_bacteria$Family), 0, 1)
taxonomy_root_bacteria$Genus <- ifelse(is.na(taxo_root_bacteria$Genus), 0, 1)
taxonomy_root_bacteria$Species <- 0
taxonomy_root_bacteria <- as.data.frame(taxonomy_root_bacteria)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root Assignation(%)` = round(nbr_bacteria_root/ 4953*100,digits=2))
View(root_bacteria_taxo)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root Assignation(%)` = round(nbr_bacteria_root/ 4310*100,digits=2))
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria Leaf Assignation(%)`, `bacteria root Assignation(%)`)
View(bacteria_assignation)
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
leaf_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
taxo_leaf_fungi <- leaf_fungi$motus %>% dplyr::select(c(4:10))
taxo_root_fungi <- root_fungi$motus %>% dplyr::select(c(4:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_fungi <- c()
taxonomy_leaf_fungi$Kingdom <- ifelse(is.na(taxo_leaf_fungi$Kingdom), 0, 1)
taxonomy_leaf_fungi$Phylum <- ifelse(is.na(taxo_leaf_fungi$Phylum), 0, 1)
taxonomy_leaf_fungi$Class <- ifelse(is.na(taxo_leaf_fungi$Class), 0, 1)
taxonomy_leaf_fungi$Order <- ifelse(is.na(taxo_leaf_fungi$Order), 0, 1)
taxonomy_leaf_fungi$Family <- ifelse(is.na(taxo_leaf_fungi$Family), 0, 1)
taxonomy_leaf_fungi$Genus <- ifelse(is.na(taxo_leaf_fungi$Genus), 0, 1)
taxonomy_leaf_fungi$Species <- ifelse(is.na(taxo_leaf_fungi$Species), 0, 1)
taxonomy_leaf_fungi <- as.data.frame(taxonomy_leaf_fungi)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `Fungi leaf Assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#now for the root dataset
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root Assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
#merge all fungi assignation information leaf + root datasets
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`Fungi leaf Assignation(%)`, `Fungi root Assignation(%)`)
bacteria_assignation <- cbind(bacteria_assignation, fungi_assignation)
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria Leaf Assignation(%)`, `bacteria root Assignation(%)`)
final_assignation <- cbind(bacteria_assignation, fungi_assignation)
View(final_assignation)
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyverse)
library(gt)
library(glue)
library(webshot2)
library(kableExtra)
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
#   kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"esai_taxa_assignation_info.png")
#data fungi
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
leaf_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
taxo_leaf_fungi <- leaf_fungi$motus %>% dplyr::select(c(4:10))
taxo_root_fungi <- root_fungi$motus %>% dplyr::select(c(4:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_fungi <- c()
taxonomy_leaf_fungi$Kingdom <- ifelse(is.na(taxo_leaf_fungi$Kingdom), 0, 1)
taxonomy_leaf_fungi$Phylum <- ifelse(is.na(taxo_leaf_fungi$Phylum), 0, 1)
taxonomy_leaf_fungi$Class <- ifelse(is.na(taxo_leaf_fungi$Class), 0, 1)
taxonomy_leaf_fungi$Order <- ifelse(is.na(taxo_leaf_fungi$Order), 0, 1)
taxonomy_leaf_fungi$Family <- ifelse(is.na(taxo_leaf_fungi$Family), 0, 1)
taxonomy_leaf_fungi$Genus <- ifelse(is.na(taxo_leaf_fungi$Genus), 0, 1)
taxonomy_leaf_fungi$Species <- ifelse(is.na(taxo_leaf_fungi$Species), 0, 1)
taxonomy_leaf_fungi <- as.data.frame(taxonomy_leaf_fungi)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `Fungi leaf assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#now for the root dataset
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
#merge all fungi assignation information leaf + root datasets
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`Fungi leaf assignation(%)`, `Fungi root assignation(%)`)
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(5:10))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(5:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- 0
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria leaf assignation(%)` = round(nbr_bacteria_leaf/ 3705*100,digits=2))
#now for the root dataset
taxonomy_root_bacteria <- c()
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$Kingdom), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$Phylum), 0, 1)
taxonomy_root_bacteria$Class <- ifelse(is.na(taxo_root_bacteria$Class), 0, 1)
taxonomy_root_bacteria$Order <- ifelse(is.na(taxo_root_bacteria$Order), 0, 1)
taxonomy_root_bacteria$Family <- ifelse(is.na(taxo_root_bacteria$Family), 0, 1)
taxonomy_root_bacteria$Genus <- ifelse(is.na(taxo_root_bacteria$Genus), 0, 1)
taxonomy_root_bacteria$Species <- 0
taxonomy_root_bacteria <- as.data.frame(taxonomy_root_bacteria)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root Assignation(%)` = round(nbr_bacteria_root/ 4310*100,digits=2))
#merge all bacteria
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria leaf assignation(%)`, `bacteria root assignation(%)`)
#data fungi
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
leaf_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
taxo_leaf_fungi <- leaf_fungi$motus %>% dplyr::select(c(4:10))
taxo_root_fungi <- root_fungi$motus %>% dplyr::select(c(4:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_fungi <- c()
taxonomy_leaf_fungi$Kingdom <- ifelse(is.na(taxo_leaf_fungi$Kingdom), 0, 1)
taxonomy_leaf_fungi$Phylum <- ifelse(is.na(taxo_leaf_fungi$Phylum), 0, 1)
taxonomy_leaf_fungi$Class <- ifelse(is.na(taxo_leaf_fungi$Class), 0, 1)
taxonomy_leaf_fungi$Order <- ifelse(is.na(taxo_leaf_fungi$Order), 0, 1)
taxonomy_leaf_fungi$Family <- ifelse(is.na(taxo_leaf_fungi$Family), 0, 1)
taxonomy_leaf_fungi$Genus <- ifelse(is.na(taxo_leaf_fungi$Genus), 0, 1)
taxonomy_leaf_fungi$Species <- ifelse(is.na(taxo_leaf_fungi$Species), 0, 1)
taxonomy_leaf_fungi <- as.data.frame(taxonomy_leaf_fungi)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `Fungi leaf assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#now for the root dataset
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `Fungi root assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
#merge all fungi assignation information leaf + root datasets
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`Fungi leaf assignation(%)`, `Fungi root assignation(%)`)
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(5:10))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(5:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- 0
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria leaf assignation(%)` = round(nbr_bacteria_leaf/ 3705*100,digits=2))
#now for the root dataset
taxonomy_root_bacteria <- c()
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$Kingdom), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$Phylum), 0, 1)
taxonomy_root_bacteria$Class <- ifelse(is.na(taxo_root_bacteria$Class), 0, 1)
taxonomy_root_bacteria$Order <- ifelse(is.na(taxo_root_bacteria$Order), 0, 1)
taxonomy_root_bacteria$Family <- ifelse(is.na(taxo_root_bacteria$Family), 0, 1)
taxonomy_root_bacteria$Genus <- ifelse(is.na(taxo_root_bacteria$Genus), 0, 1)
taxonomy_root_bacteria$Species <- 0
taxonomy_root_bacteria <- as.data.frame(taxonomy_root_bacteria)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root assignation(%)` = round(nbr_bacteria_root/ 4310*100,digits=2))
#merge all bacteria
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria leaf assignation(%)`, `bacteria root assignation(%)`)
#merge bacteria and fungi
final_assignation <- cbind(bacteria_assignation, fungi_assignation)
#make pretty table
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyverse)
library(gt)
library(glue)
library(webshot2)
library(kableExtra)
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
#data fungi
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
leaf_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_fungi <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
taxo_leaf_fungi <- leaf_fungi$motus %>% dplyr::select(c(4:10))
taxo_root_fungi <- root_fungi$motus %>% dplyr::select(c(4:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_fungi <- c()
taxonomy_leaf_fungi$Kingdom <- ifelse(is.na(taxo_leaf_fungi$Kingdom), 0, 1)
taxonomy_leaf_fungi$Phylum <- ifelse(is.na(taxo_leaf_fungi$Phylum), 0, 1)
taxonomy_leaf_fungi$Class <- ifelse(is.na(taxo_leaf_fungi$Class), 0, 1)
taxonomy_leaf_fungi$Order <- ifelse(is.na(taxo_leaf_fungi$Order), 0, 1)
taxonomy_leaf_fungi$Family <- ifelse(is.na(taxo_leaf_fungi$Family), 0, 1)
taxonomy_leaf_fungi$Genus <- ifelse(is.na(taxo_leaf_fungi$Genus), 0, 1)
taxonomy_leaf_fungi$Species <- ifelse(is.na(taxo_leaf_fungi$Species), 0, 1)
taxonomy_leaf_fungi <- as.data.frame(taxonomy_leaf_fungi)
leaf_fungi_taxo <- as.data.frame(colSums(taxonomy_leaf_fungi)) %>% rename(nbr_fungi_leaf= `colSums(taxonomy_leaf_fungi)`) %>% mutate( `fungi leaf assignation(%)` = round(nbr_fungi_leaf/ 10099*100,digits=2))
#now for the root dataset
taxonomy_root_fungi <- c()
taxonomy_root_fungi$Kingdom <- ifelse(is.na(taxo_root_fungi$Kingdom), 0, 1)
taxonomy_root_fungi$Phylum <- ifelse(is.na(taxo_root_fungi$Phylum), 0, 1)
taxonomy_root_fungi$Class <- ifelse(is.na(taxo_root_fungi$Class), 0, 1)
taxonomy_root_fungi$Order <- ifelse(is.na(taxo_root_fungi$Order), 0, 1)
taxonomy_root_fungi$Family <- ifelse(is.na(taxo_root_fungi$Family), 0, 1)
taxonomy_root_fungi$Genus <- ifelse(is.na(taxo_root_fungi$Genus), 0, 1)
taxonomy_root_fungi$Species <- ifelse(is.na(taxo_root_fungi$Species), 0, 1)
taxonomy_root_fungi <- as.data.frame(taxonomy_root_fungi)
root_fungi_taxo <- as.data.frame(colSums(taxonomy_root_fungi)) %>% rename(nbr_fungi_root= `colSums(taxonomy_root_fungi)`) %>% mutate( `fungi root assignation(%)` = round(nbr_fungi_root/ 5573*100,digits=2))
#merge all fungi assignation information leaf + root datasets
fungi_assignation <- cbind(leaf_fungi_taxo, root_fungi_taxo) %>% dplyr::select(`fungi leaf assignation(%)`, `fungi root assignation(%)`)
#now for bacteria dataset
load("./results/Metabarlist_natura_clean_16S.Rdata")
leaf_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root_bacteria <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#leaf
taxo_leaf_bacteria <- leaf_bacteria$motus %>% dplyr::select(c(5:10))
taxo_root_bacteria <- root_bacteria$motus %>% dplyr::select(c(5:10))
#count number of non-NA in each column for the leaf dataset
taxonomy_leaf_bacteria <- c()
taxonomy_leaf_bacteria$Kingdom <- ifelse(is.na(taxo_leaf_bacteria$Kingdom), 0, 1)
taxonomy_leaf_bacteria$Phylum <- ifelse(is.na(taxo_leaf_bacteria$Phylum), 0, 1)
taxonomy_leaf_bacteria$Class <- ifelse(is.na(taxo_leaf_bacteria$Class), 0, 1)
taxonomy_leaf_bacteria$Order <- ifelse(is.na(taxo_leaf_bacteria$Order), 0, 1)
taxonomy_leaf_bacteria$Family <- ifelse(is.na(taxo_leaf_bacteria$Family), 0, 1)
taxonomy_leaf_bacteria$Genus <- ifelse(is.na(taxo_leaf_bacteria$Genus), 0, 1)
taxonomy_leaf_bacteria$Species <- 0
taxonomy_leaf_bacteria <- as.data.frame(taxonomy_leaf_bacteria)
leaf_bacteria_taxo <- as.data.frame(colSums(taxonomy_leaf_bacteria)) %>% rename(nbr_bacteria_leaf= `colSums(taxonomy_leaf_bacteria)`) %>% mutate( `bacteria leaf assignation(%)` = round(nbr_bacteria_leaf/ 3705*100,digits=2))
#now for the root dataset
taxonomy_root_bacteria <- c()
taxonomy_root_bacteria$Kingdom <- ifelse(is.na(taxo_root_bacteria$Kingdom), 0, 1)
taxonomy_root_bacteria$Phylum <- ifelse(is.na(taxo_root_bacteria$Phylum), 0, 1)
taxonomy_root_bacteria$Class <- ifelse(is.na(taxo_root_bacteria$Class), 0, 1)
taxonomy_root_bacteria$Order <- ifelse(is.na(taxo_root_bacteria$Order), 0, 1)
taxonomy_root_bacteria$Family <- ifelse(is.na(taxo_root_bacteria$Family), 0, 1)
taxonomy_root_bacteria$Genus <- ifelse(is.na(taxo_root_bacteria$Genus), 0, 1)
taxonomy_root_bacteria$Species <- 0
taxonomy_root_bacteria <- as.data.frame(taxonomy_root_bacteria)
root_bacteria_taxo <- as.data.frame(colSums(taxonomy_root_bacteria)) %>% rename(nbr_bacteria_root= `colSums(taxonomy_root_bacteria)`) %>% mutate( `bacteria root assignation(%)` = round(nbr_bacteria_root/ 4310*100,digits=2))
#merge all bacteria
bacteria_assignation <- cbind(leaf_bacteria_taxo, root_bacteria_taxo) %>% dplyr::select(`bacteria leaf assignation(%)`, `bacteria root assignation(%)`)
#merge bacteria and fungi
final_assignation <- cbind(bacteria_assignation, fungi_assignation)
#make pretty table
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyverse)
library(gt)
library(glue)
library(webshot2)
library(kableExtra)
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
#kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =T, padding = -1L) %>%
kable_classic_2(full_width = F) %>%
kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
kbl(final_assignation, caption ="Percentage of taxonomic assignation", escape =F, padding = -1L, font_size=25) %>%
kable_classic_2(full_width = F) %>%
kable_styling(font_size = 20) %>%
row_spec(0, bold = TRUE, font_size = 15) %>%
footnote(general = "Taxonomic assignment was done using SILVA for 16S (Quast et al., 2012) (Version: 1.9.10 / 1.4.9; SILVA: r138.1 - Last Updated: 14.03.2023) and UNITE for ITS2 (Abarenkov et al., 2021) (Version: 16.10.2022). ") %>%
save_kable(
"essai_taxa_assignation_info.png")
