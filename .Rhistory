plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=0.7,label="T.test, p-value=0.43", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106.09", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot_hell.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
ggsave("./results/null/plot_final_ndv.jpeg", NDV_final_plot, width = 10, height = 8 )
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_ITS_leaf.RData") #leaf
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_fun.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root.RData") #root
load("./results/null/bray_abund_null_dev_fun_root.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
# load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_16S_leaf.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#datasets----------
load("./resources/Metabarlist_natura_clean_ITS2_traits_alpha.Rdata") #fungi
# leaf------------
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
leaf$reads
# Prepare and calculate abundance beta-null deviation metric
comm.t=t(leaf$reads) #transpose reads
View(comm.t)
# Prepare and calculate abundance beta-null deviation metric
comm.t=t(leaf$reads) #transpose reads
# Prepare and calculate abundance beta-null deviation metric
comm.t=leaf$reads #transpose reads
View(comm.t)
bbs.sp.site <- comm.t
patches=nrow(bbs.sp.site)
patches
#
# ## Calculate beta-diversity for observed metacommunity
beta_comm_abund <- vegdist(comm.t.root, "bray")
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
#ITS
# load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
# load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
load("./results/null/bray_abund_null_dev_fun.RData") #leaf
load("./results/null/bray_abund_null_dev_fun_root.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P ***", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.35, 1.05)
plot_ITS
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.35, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0, 1.05)
plot_ITS
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S
ggsave("./results/plot_16S_ndv_nontranspose_boxplot.jpeg", plot_16S)
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
plot_ITS <- ggplot()+
geom_violin(data=ndv_ITS_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_ITS_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
# ggtitle("Fungi null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -18.01, df = 106", size = 6)+
annotate("text",x=1.5,y=0.9,label="P < 2.2e-16", size = 6)+
theme_minimal(base_size =25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_ITS
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_16S_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_16S_leaf)<-c("NDV")
colnames(ndv_16S_root)<-c("NDV")
plot_16S <- ggplot()+
geom_violin(data=ndv_16S_leaf,aes(x=factor(0),y=NDV),colour="black", fill="#009E73",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE) +
geom_violin(data=ndv_16S_root,aes(x=factor(1),y=NDV),colour="black",fill="#E69F00",draw_quantiles = c(0.25,0.5,0.75),trim=FALSE)+
scale_x_discrete(breaks=c(0,1),labels=c("Leaf","Root"))+
#ggtitle("Bacteria null beta-distribution")+
annotate("text",x=1.5,y=1,label="t = -1.8, df = 103", size = 6)+
annotate("text",x=1.5,y=0.9,label="P = 0.24", size = 6)+
theme_minimal(base_size = 25)+
theme(axis.title.x = element_blank())+
ylim(0.2, 1.05)
plot_16S
NDV_final_plot <- ggarrange(plot_16S, plot_ITS, labels = c("Bacteria", "Fungi"))
NDV_final_plot
ggsave("./results/null/plot_final_ndv.jpeg", NDV_final_plot, width = 10, height = 8 )
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
ndv_16S_leaf <-data.frame(bray_abund_null_dev_fun)
load("./results/null/bray_abund_null_dev_16S_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_16S_root_nontranspose.RData") #root
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
#ITS
load("./results/null/bray_abund_null_dev_ITS_leaf_nontranspose.RData") #leaf
load("./results/null/bray_abund_null_dev_ITS_root_nontranspose.RData") #root
ndv_ITS_leaf <-data.frame(bray_abund_null_dev_fun)
ndv_ITS_root <-data.frame(bray_abund_null_dev_fun_root)
colnames(ndv_ITS_leaf)<-c("NDV")
colnames(ndv_ITS_root)<-c("NDV")
boxplot(bray_abund_null_dev_fun, bray_abund_null_dev_fun_root,outline=FALSE)
t.test(bray_abund_null_dev_fun,bray_abund_null_dev_fun_root, alternative = "two.sided", var.equal = FALSE)
set.seed(123456)
library(tidyverse)
library(labdsv)
library(dplyr)
library(FactoMineR)
library(car)
library(missMDA)
library(metabaR)
library(ggplot2)
library(corrplot)
library(factoextra)
library(MASS)
library(cowplot)
library(MuMIn)
library(multcomp)
library(ggpubr)
library(ade4)
library(hillR)
library(adespatial)
library(reldist)
library(bipartite)
library(vegan)
library(scales)
library(phyloseq)
library(reshape2)
library(ggpubr)
library(purrr)
library(stringr)
library(BiocManager)
#BiocManager::install("microbiome")
library(microbiome)
# Enable the r-universe repo
# options(repos = c(
#     fawda123 = 'https://fawda123.r-universe.dev',
#     CRAN = 'https://cloud.r-project.org'))
# Install ggord
#install.packages('ggord')
library(ggord) #simple package for creating ordination plots with ggplot2. Marcus W. Beck (2017). ggord: Ordination Plots with ggplot2. R package version 1.0.0. https://zenodo.org/badge/latestdoi/35334615
setwd("E:/Sophie_pipeline/obitools")
#data
load("E:/Sophie_pipeline/obitools/resources/Metabarlist_natura_clean_ITS2_traits.Rdata")
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
root <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root")
#Hill numbers, using HillR package
Shannon_fungi_natura_clean <-hill_taxa(natura_clean$reads,q=1) #equivalent of Shannon entropy
df <- Shannon_fungi_natura_clean %>%
enframe() %>%
rename(Shannon = value,
sample_id = name)
natura_clean$samples <- left_join(natura_clean$samples, df)
#save data with alpha diversity measures
row.names(natura_clean$samples) <- natura_clean$samples$sample_id
#with traits & indices
save(natura_clean, file = "./resources/Metabarlist_natura_clean_ITS2_traits_alpha.Rdata")
load("./resources/Metabarlist_natura_clean_ITS2_traits_alpha.Rdata")
leaf <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "leaf")
#traits normalized
traits_norm <- read_csv("resources/DRYER_natura_imputed_traits_norm.csv")
traits_norm$code <- as.character(traits_norm$code)
traits <- left_join(leaf$samples %>% dplyr::select(code, Shannon), traits_norm)
#test normality shannon
ggqqplot(traits$Shannon)
ggdensity(traits$Shannon)
shapiro.test(traits$Shannon) # non normal p-value<0.0001
#transform Shannon to meet normality
bc<-boxcox(traits$Shannon~1)
(lambda <- bc$x[which.max(bc$y)])
## 2
new_model <- lm(((traits$Shannon^lambda-1)/lambda) ~ 1)
qqnorm(new_model$residuals)
qqline(new_model$residuals)
traits$norm_Shannon<-(traits$Shannon^lambda-1)/lambda
#traits
names(traits)
env <- traits[,c(7,40:45,33:36, 51)] #only leaf traits
# Prior to constructing the model, root functional trait variables were mean-centered and scaled to unit variance.
names(env)
env.scale <- scale(env[,-c(1,12)], center = TRUE, scale = TRUE) #scale traits not the indices
env.scale <-as.data.frame(env.scale)
rest <- env[,c(1,12)]
env.scale <- cbind(env.scale, rest)
#check collinearity with VIF on lm (<5)
names(env.scale)
lm.leaf.ITS <-lm(norm_Shannon~ norm_LSWC + norm_StomatalDensity +norm_LT +norm_gmin + norm_SLA + norm_TotalLeafArea+Name+ MEM1 + MEM2+MEM3+MEM4, env.scale)
summary(lm.leaf.ITS)
vif(lm.leaf.ITS) #nothing to remove all <5
lm.leaf.ITS.step<-stepAIC(lm.leaf.ITS,direction="both")
vif(lm.leaf.ITS.step) # <10
summary(lm.leaf.ITS.step)
#table
# library(jtools)
# c<- summ(lm.leaf.ITS.step)
RsquareAdj(lm.leaf.ITS.step)
#
# $r.squared
# [1] 0.4999709
#
# $adj.r.squared
# [1] 0.4354511
library(jtools)
table <- data.frame(summ(lm.leaf.ITS.step)$coeftable)
write.csv(table, "Shannon_leaf_fungi.csv")
lm.leaf.ITS <-lm(norm_Shannon~ norm_LSWC + norm_StomatalDensity +norm_LT +norm_gmin + norm_SLA + norm_TotalLeafArea+Name+ MEM1 + MEM2+MEM3+MEM4, env.scale)
summary(lm.leaf.ITS)
lm.leaf.ITS <-aov(terms(norm_Shannon~ norm_LSWC + norm_StomatalDensity +norm_LT +norm_gmin + norm_SLA + norm_TotalLeafArea+Name+ MEM1 + MEM2+MEM3+MEM4, env.scale)
lm.leaf.ITS <-aov(terms(norm_Shannon~ norm_LSWC + norm_StomatalDensity +norm_LT +norm_gmin + norm_SLA + norm_TotalLeafArea+Name+ MEM1 + MEM2+MEM3+MEM4, env.scale))
lm.leaf.ITS <-aov(terms(norm_Shannon~ norm_LSWC +
norm_StomatalDensity +
norm_LT +
norm_gmin +
norm_SLA +
norm_TotalLeafArea+
Name+
MEM1 +
MEM2+
MEM3+
MEM4, keep.order = T), data=env.scale)
summary(lm.leaf.ITS)
vif(lm.leaf.ITS) #nothing to remove all <5
lm.leaf.ITS.step<-stepAIC(lm.leaf.ITS,direction="both")
vif(lm.leaf.ITS.step) # <10
summary(lm.leaf.ITS.step)
RsquareAdj(lm.leaf.ITS.step)
lm.leaf.ITS.step
lm.leaf.ITS <-aov(terms(norm_Shannon~ norm_LSWC +
norm_StomatalDensity +
norm_LT +
norm_gmin +
norm_SLA +
norm_TotalLeafArea+
Name+
MEM1 +
MEM2+
MEM3+
MEM4), data=env.scale)
summary(lm.leaf.ITS)
vif(lm.leaf.ITS) #nothing to remove all <5
lm.leaf.ITS.step<-stepAIC(lm.leaf.ITS,direction="both")
vif(lm.leaf.ITS.step) # <10
plot(lm.leaf.ITS)
plot(lm.leaf.ITS.step)
norm_StomatalDensity +
norm_LT +
norm_gmin +
norm_SLA +
norm_TotalLeafArea+
Name+
MEM1 +
MEM2+
MEM3+
MEM4, data=env.scale)
summary(lm.leaf.ITS)
lm.leaf.ITS <-lm(norm_Shannon~ norm_LSWC +
norm_StomatalDensity +
norm_LT +
norm_gmin +
norm_SLA +
norm_TotalLeafArea+
Name+
MEM1 +
MEM2+
MEM3+
MEM4, data=env.scale)
summary(lm.leaf.ITS)
summary_lm <-                           MEM4, data=env.scale)
summary_lm <- summary(lm.leaf.ITS)
summary_lm$coefficients
summary_lm$coefficients[,1:2]
summary_lm$terms
View(summary_lm)
summary_lm[["terms"]][[1]]
