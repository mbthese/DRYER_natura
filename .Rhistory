indices = natura_clean$samples$organ == "leaf")
hill <- hill_taxa_parti_pairwise(leaf$reads,q=1,output="matrix", pairs = "full")
hill.beta  <- hill$TD_beta
hill.beta.dist  <- as.dist(hill.beta)
mod.leaf <- betadisper(d = hill.beta.dist, group = as.factor(leaf$samples$Name), type = "median")
mod.leaf
# tests if centroid distances are significantly different from each other
anova(mod.leaf) #no 0.6947
leaf_tuket <- TukeyHSD(mod.leaf) #aucune paires de significatives
plot(mod.leaf)
# Dimension 1 & 2 (i.e., Axis 1 (PCOA1))
Axis1.percent <- mod.leaf$eig[1]/ sum(mod.leaf$eig) * 100 #44.69416
Axis2.percent <-  mod.leaf$eig[2]/ sum(mod.leaf$eig) * 100 #14.98621
#have a better plot
betadisper_dat <- get_betadisper_data(mod.leaf)
betadisper_dat$eigenvalue <- mutate(betadisper_dat$eigenvalue, percent = eig/sum(eig))
betadisper_dat$chull <- group_by(betadisper_dat$eigenvector, group) %>%
do(data.frame(PCoA1 = .$PCoA1[c(chull(.$PCoA1, .$PCoA2), chull(.$PCoA1, .$PCoA2)[1])],
PCoA2 = .$PCoA2[c(chull(.$PCoA1, .$PCoA2), chull(.$PCoA1, .$PCoA2)[1])])) %>%
data.frame()
betadisper_lines <- merge(dplyr::select(betadisper_dat$centroids, group, PCoA1, PCoA2), dplyr::select(betadisper_dat$eigenvector, group, PCoA1, PCoA2), by = c('group'))
betadisper_lines <- betadisper_lines %>%
mutate(group = gsub("_", " ", group)) %>%
separate(group, c("Genus", "Species")) %>%
mutate(group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
dplyr::select(-Genus, -Species)
betadisper_dat$centroids <- betadisper_dat$centroids %>%
mutate(group = gsub("_", " ", group)) %>%
separate(group, c("Genus", "Species")) %>%
mutate(group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
dplyr::select(-Genus, -Species)
betadisper_dat$eigenvector <- betadisper_dat$eigenvector %>%
mutate(group = gsub("_", " ", group)) %>%
separate(group, c("Genus", "Species")) %>%
mutate(group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
dplyr::select(-Genus, -Species)
betadisper_dat$chull <- betadisper_dat$chull %>%
mutate(group = gsub("_", " ", group)) %>%
separate(group, c("Genus", "Species")) %>%
mutate(group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
dplyr::select(-Genus, -Species)
pcoa_beta_leaf <-  ggplot() +
geom_point(aes(PCoA1, PCoA2, col = group), betadisper_dat$centroids, size = 4 ) +
geom_point(aes(PCoA1, PCoA2, col = group), betadisper_dat$eigenvector) +
geom_path(aes(PCoA1, PCoA2, group =  group, col = group), betadisper_dat$chull) +
# geom_segment(aes(x = PCoA1.x, y = PCoA2.x, yend = PCoA2.y, xend = PCoA1.y, group = group, col = group), betadisper_lines) +
theme_classic(base_size = 12, base_family = 'Helvetica') +
ylab('PCoA 2 - 6.3%') +
xlab('PCoA 1 - 10.0%') +
ggtitle("Leaf") +
theme(plot.title = element_text(color = "#6bbf59", face = "bold"), legend.position = 'bottom', legend.text = element_text(face= "italic", size = 14)) +
labs(col = "Species")
pcoa_beta_leaf
Axis1.percent
Axis2.percent
pcoa_beta_leaf
# extract the legend as a text grob for later
legend_grob <- get_legend( pcoa_beta_leaf  )
# draw the legend as a standalone plot for later
legend_plot <- gridExtra::arrangeGrob(legend_grob, ncol = 1)
# Draw a boxplot of the distances to centroid for each group
boxplot(mod.leaf)
df <- data.frame(Distance_to_centroid=mod.leaf$distances,Group=mod.leaf$group)
groups <- mod.leaf$group
## Permutation test for F
set.seed(12345)
r.leaf <- permutest(mod.leaf, pairwise = TRUE, permutations = 99)
leaf<- df %>%
mutate(name = gsub("_", " ", Group)) %>%
separate(name, c("Genus", "Species")) %>%
mutate(Group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
ggplot(aes(x=Group,y=Distance_to_centroid,colour=groups)) +
geom_boxplot(alpha=0.5) +
ylab('Distance \n to centroid') +
theme_classic(base_size = 12)+
# annotate(geom="text", x=1, y=0.69, label="Permutation test",color="black")+
annotate(geom="text", x=4, y=1.4, label="p-value=0.8",
color="black")+
theme(legend.position = "none", axis.title.x =element_blank(), axis.text.x = element_blank())
leaf
#Combine the two graphs
Beta_leaf <- ggarrange(pcoa_beta_leaf , leaf, ncol = 2, nrow = 1, widths = c(1, 0.7), common.legend = TRUE, legend = "none", labels = c("C", "D"))
Beta_leaf
root <- subset_metabarlist(natura_clean, table = "samples",
indices = natura_clean$samples$organ == "root" & natura_clean$samples$Genus != "Tachigali") #because too few individuals
hill<- hill_taxa_parti_pairwise(root$reads,q=1,output="matrix", pairs = "full")
hill.beta  <- hill$TD_beta
hill.beta.dist  <- as.dist(hill.beta)
mod.root <- betadisper(d = hill.beta.dist, group = as.factor(root$samples$Name), type = "median")
mod.root
# tests if centroid distances are significantly different from each other
anova(mod.root) #  0.5625
root_tuket <- TukeyHSD(mod.root) #aucune paires de significatives
plot(mod.root)
# Dimension 1 & 2 (i.e., Axis 1 (PCOA1))
Axis1.percent <- mod.root$eig[1]/ sum(mod.root$eig) * 100 #6.8
Axis2.percent <-  mod.root$eig[2]/ sum(mod.root$eig) * 100 #6.03
#have a better plot
betadisper_dat <- get_betadisper_data(mod.root)
betadisper_dat$eigenvalue <- mutate(betadisper_dat$eigenvalue, percent = eig/sum(eig))
betadisper_dat$chull <- group_by(betadisper_dat$eigenvector, group) %>%
do(data.frame(PCoA1 = .$PCoA1[c(chull(.$PCoA1, .$PCoA2), chull(.$PCoA1, .$PCoA2)[1])],
PCoA2 = .$PCoA2[c(chull(.$PCoA1, .$PCoA2), chull(.$PCoA1, .$PCoA2)[1])])) %>%
data.frame()
betadisper_lines <- merge(dplyr::select(betadisper_dat$centroids, group, PCoA1, PCoA2), dplyr::select(betadisper_dat$eigenvector, group, PCoA1, PCoA2), by = c('group'))
pcoa_beta_root <- ggplot() +
geom_point(aes(PCoA1, PCoA2, col = group), betadisper_dat$centroids, size = 4 ) +
geom_point(aes(PCoA1, PCoA2, col = group), betadisper_dat$eigenvector) +
geom_path(aes(PCoA1, PCoA2, col = group, group = group), betadisper_dat$chull ) +
#geom_segment(aes(x = PCoA1.x, y = PCoA2.x, yend = PCoA2.y, xend = PCoA1.y, group = row.names(betadisper_lines), col = group), betadisper_lines) +
theme_classic(base_size = 12, base_family = 'Helvetica') +
ylab('PCoA 2 - 6.0%') +
xlab('PCoA 1 - 6.8%') +
theme(legend.position = 'bottom') +
ggtitle("Root")+
theme(plot.title = element_text(color = "#E79F02", face = "bold"))+
scale_color_manual(values = group_colors_sans_tachi)
pcoa_beta_root
# Draw a boxplot of the distances to centroid for each group
boxplot(mod.root)
df <- data.frame(Distance_to_centroid=mod.root$distances,Group=mod.root$group)
groups <- mod.root$group
## Permutation test for F
set.seed(12345)
r.root <- permutest(mod.root, pairwise = TRUE, permutations = 99) #0.59
root<- df %>%
mutate(name = gsub("_", " ", Group)) %>%
separate(name, c("Genus", "Species")) %>%
mutate(Group = paste0(substr(Genus, 1, 1), ".", " ", Species)) %>%
ggplot(aes(x=Group,y=Distance_to_centroid,colour=groups)) +
geom_boxplot(alpha=0.5) +
ylab('Distance \n to centroid') +
theme_classic(base_size = 12)+
# annotate(geom="text", x=1, y=0.69, label="Permutation test", color="black")+
annotate(geom="text", x=3.5, y=1.4, label="p-value=0.6",
color="black")+
theme(legend.position = "none", axis.title.x =element_blank(), axis.text.x = element_blank())+
scale_color_manual(values = group_colors_sans_tachi)
root
#Combine the two graphs
Beta_root <- ggarrange(pcoa_beta_root , root, ncol = 2, nrow = 1, widths = c(1,0.7), common.legend = TRUE, legend = "none", labels= c("E", "F"))
Beta_root
Beta_option1 <- ggarrange(Beta_all, ggarrange(Beta_leaf, Beta_root, ncol = 2, nrow = 1), legend_plot, nrow = 3, heights = c(2,1, 0.5))
Beta_option2 <- ggarrange(Beta_all, Beta_leaf, Beta_root,legend_plot, ncol = 1, nrow = 4, heights = c(1,1,1, 0.3), widths = c(0.5, 0.5,0.5,1))
Beta_option2
ggsave("./results/Beta_ITS.jpeg", Beta_option2, width = 9, height = 7)
#LEAF
load("./results/Metabarlist_natura_clean_16S_leaf.Rdata")
summary(leaf_metabar_clean)
leaf_metabar_clean$samples$nb_reads <- rowSums(leaf_metabar_clean$reads) #get number of reads per sample
leaf_metabar_clean$samples$nb_motus <- rowSums(leaf_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
#-------------------------------------------------------------------
#ROOT
load("./results/Metabarlist_natura_clean_16S_root.Rdata") #name: root_metabar_clean
summary(root_metabar_clean)
root_metabar_clean$samples$nb_reads <- rowSums(root_metabar_clean$reads) #get number of reads per sample
root_metabar_clean$samples$nb_motus <- rowSums(root_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_bacteria <- rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_bacteria = n,
mean_nb_reads_bacteria = mean_nb_reads,
mean_nb_motus_bacteria = mean_nb_motus)
##FUNGI
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
summary_metabarlist(natura_clean)
#LEAF
load("./results/Metabarlist_leaf_clean_ITS2.Rdata")
summary_metabarlist(leaf_ITS_clean)
leaf_ITS_clean$samples$nb_reads <- rowSums(leaf_ITS_clean$reads) #get number of reads per sample
leaf_ITS_clean$samples$nb_motus <- rowSums(leaf_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
#-------------------------------------------------------------------
#ROOT
load("./results/Metabarlist_root_clean_ITS2.Rdata") #name: root_metabar_clean
summary_metabarlist(root_ITS_clean)
root_ITS_clean$samples$nb_reads <- rowSums(root_ITS_clean$reads) #get number of reads per sample
root_ITS_clean$samples$nb_motus <- rowSums(root_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_fungi <- rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_fungi = n,
mean_nb_reads_fungi = mean_nb_reads,
mean_nb_motus_fungi = mean_nb_motus)
table <- left_join(table_bacteria, table_fungi)
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE) %>% #title
pack_rows(index = c("root" = 7, "leaf" = 7)) %>% #to group by organ
row_spec(0, bold = TRUE) %>% #first row is in bold
column_spec(1, italic = T, width = "1em") %>% #make species name in italic
kable_classic(html_font = "Cambria") %>%
kable_styling(font_size = 20) %>%
save_kable(file = "./results/summary.png") #make it bigger add zoom = 5 in save_kable
#LEAF
load("./results/Metabarlist_natura_clean_16S_leaf.Rdata")
summary(leaf_metabar_clean)
leaf_metabar_clean$samples$nb_reads <- rowSums(leaf_metabar_clean$reads) #get number of reads per sample
leaf_metabar_clean$samples$nb_motus <- rowSums(leaf_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
leaf
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
table_leaf
root_metabar_clean$samples$nb_reads <- rowSums(root_metabar_clean$reads) #get number of reads per sample
root_metabar_clean$samples$nb_motus <- rowSums(root_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_root
table_root
table_leaf
rbind(table_root, table_leaf)
rbind(table_root, table_leaf) %>%
relocate(organ, .before =name)
rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name))
rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name)
rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_bacteria = n,
mean_nb_reads_bacteria = mean_nb_reads,
mean_nb_motus_bacteria = mean_nb_motus)
table_bacteria <- rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_bacteria = n,
mean_nb_reads_bacteria = mean_nb_reads,
mean_nb_motus_bacteria = mean_nb_motus)
table_bacteria
##FUNGI
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
summary_metabarlist(natura_clean)
#LEAF
load("./results/Metabarlist_leaf_clean_ITS2.Rdata")
summary_metabarlist(leaf_ITS_clean)
leaf_ITS_clean$samples$nb_reads <- rowSums(leaf_ITS_clean$reads) #get number of reads per sample
leaf_ITS_clean$samples$nb_motus <- rowSums(leaf_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
table_leaf
#-------------------------------------------------------------------
#ROOT
load("./results/Metabarlist_root_clean_ITS2.Rdata") #name: root_metabar_clean
summary_metabarlist(root_ITS_clean)
root_ITS_clean$samples$nb_reads <- rowSums(root_ITS_clean$reads) #get number of reads per sample
root_ITS_clean$samples$nb_motus <- rowSums(root_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_fungi <- rbind(table_root, table_leaf) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_fungi = n,
mean_nb_reads_fungi = mean_nb_reads,
mean_nb_motus_fungi = mean_nb_motus)
table <- left_join(table_bacteria, table_fungi)
table_bacteria
load("./results/Metabarlist_natura_clean_16S_leaf.Rdata")
summary(leaf_metabar_clean)
leaf_metabar_clean$samples$nb_reads <- rowSums(leaf_metabar_clean$reads) #get number of reads per sample
leaf_metabar_clean$samples$nb_motus <- rowSums(leaf_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
#-------------------------------------------------------------------
#ROOT
load("./results/Metabarlist_natura_clean_16S_root.Rdata") #name: root_metabar_clean
summary(root_metabar_clean)
root_metabar_clean$samples$nb_reads <- rowSums(root_metabar_clean$reads) #get number of reads per sample
root_metabar_clean$samples$nb_motus <- rowSums(root_metabar_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_metabar_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_bacteria <- rbind(table_leaf, table_root) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_bacteria = n,
mean_nb_reads_bacteria = mean_nb_reads,
mean_nb_motus_bacteria = mean_nb_motus)
table_bacteria
load("./results/Metabarlist_natura_clean_ITS2.Rdata")
summary_metabarlist(natura_clean)
#LEAF
load("./results/Metabarlist_leaf_clean_ITS2.Rdata")
summary_metabarlist(leaf_ITS_clean)
leaf_ITS_clean$samples$nb_reads <- rowSums(leaf_ITS_clean$reads) #get number of reads per sample
leaf_ITS_clean$samples$nb_motus <- rowSums(leaf_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
leaf2 <- melt(leaf_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
leaf3 <- leaf2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (leaf) per species
leaf <- leaf2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_leaf <- left_join(leaf3, leaf)
table_leaf$organ <- "leaf"
#-------------------------------------------------------------------
#ROOT
load("./results/Metabarlist_root_clean_ITS2.Rdata") #name: root_metabar_clean
summary_metabarlist(root_ITS_clean)
root_ITS_clean$samples$nb_reads <- rowSums(root_ITS_clean$reads) #get number of reads per sample
root_ITS_clean$samples$nb_motus <- rowSums(root_ITS_clean$reads>0) #get number of OTUs per sample
#to get number of motus and reads
root2 <- melt(root_ITS_clean$samples,id = c("name", "nb_reads", "nb_motus"))
root3 <- root2 %>%
group_by(name) %>%
summarise(mean_nb_reads = round(mean(nb_reads)),
mean_nb_motus = round(mean(nb_motus)))
#to get number of samples (root) per species
root <- root2 %>%
filter(variable == "sample_id") %>%
group_by(name) %>%
summarise(n= n())
#table of number of reads, OTU and samples per species
table_root <- left_join(root3, root)
table_root$organ <- "root"
table_fungi <- rbind(table_leaf, table_root) %>%
relocate(organ, .before =name) %>%
relocate(n, .before = mean_nb_reads) %>%
mutate(name = gsub("_", " ", name)) %>%
rename(Species = name) %>%
rename(n_fungi = n,
mean_nb_reads_fungi = mean_nb_reads,
mean_nb_motus_fungi = mean_nb_motus)
table_bacteria
table_fungi
table_fungi
left_join(table_bacteria, table_fungi)
left_join(table_bacteria, table_fungi)
table <- left_join(table_bacteria, table_fungi)
View(table)
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE)
library(kableExtra)
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE)
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE) %>% #title
pack_rows(index = c("root" = 7, "leaf" = 7)) %>% #to group by organ
row_spec(0, bold = TRUE) %>% #first row is in bold
column_spec(1, italic = T, width = "1em") %>% #make species name in italic
kable_classic(html_font = "Cambria") %>%
kable_styling(font_size = 20)
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE) %>% #title
pack_rows(index = c("root" = 7, "leaf" = 7)) %>% #to group by organ
row_spec(0, bold = TRUE) %>% #first row is in bold
column_spec(1, italic = T, width = "1em") %>% #make species name in italic
kable_classic(html_font = "Cambria") %>%
kable_styling(font_size = 20) %>%
save_kable(file = "./results/summary.png") #make it bigger add zoom = 5 in save_kable
table
table %>%
dplyr::select(-organ) %>% #remove it otherwise redundant
kbl(escape = FALSE) %>% #title
pack_rows(index = c("leaf" = 7, "root" = 7)) %>% #to group by organ
row_spec(0, bold = TRUE) %>% #first row is in bold
column_spec(1, italic = T, width = "1em") %>% #make species name in italic
kable_classic(html_font = "Cambria") %>%
kable_styling(font_size = 20) %>%
save_kable(file = "./results/summary.png") #make it bigger add zoom = 5 in save_kable
